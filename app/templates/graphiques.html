{% extends "base.html" %}

{% block content %}
<script src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.js'></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
    <body onload ="update_values();">
        <h1>Dynamic Update</h1>
        <p id=resultx>?</p> 
        <p id=resulty>?</p>
        <p>
            <div>
                <canvas id="myChart" width=".02em" height=".02em"></canvas>
                <canvas id="myChart2" width=".02em" height=".02em"></canvas>
            </div>

            <script type="text/javascript">
                var intervalID = setInterval(update_values,1000);
                var c=0;
                var x_coord;
                var y_coord;
                    function update_values(){
                        $.getJSON('/_robotData',
                        function(data){
                            $('#resultx').text(data.resultx);
                            $('#resulty').text(data.resulty);
                            x_coord=data.resultx;
                            y_coord=data.resulty;
                            console.log(data)
                        });
                        
                        c=c+1;
                        
                        console.log(c);
                        console.log(x_coord);
                        console.log(y_coord);
                        myChart.data.labels.push(c);
                        myChart.data.datasets.forEach((dataset )=> {
                            dataset.data.push(x_coord);
                            dataset.data.push(y_coord);
                        });
                        
                        myChart.update();
                    };
                    var ctx = document.getElementById('myChart');
                    var myChart = new Chart(ctx, {
                        type: 'scatter',
                        data: {
                            labels: [c],
                            datasets: [{
                                label: 'Robot speed',
                                data: [{
                                    x: x_coord,
                                    y: y_coord
                                }],
                                backgroundColor: [
                                    'rgba(102, 255, 153, 1)',

                                ],
                                borderColor: [
                                    'rga(255, 0, 0, 1)',

                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                xAxes: [{
                                    type: 'linear',
                                    position: 'bottom'
                                }],
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        }
                    });
            </script>
        </p>

        </body>
{% endblock %}